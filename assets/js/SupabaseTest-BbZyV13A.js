import{j as e,L as s,A as a}from"./vendor-ui-CYdTg3fb.js";import{a as t}from"./vendor-react-CGzs7eOH.js";import{A as n}from"./AuthForm-CcDV3gKp.js";import{u as d,l as i,m as l,n as r,s as c,o}from"./index-CD69gdBK.js";import"./vendor-leaflet-DNyTttW1.js";import"./vendor-supabase-CS0gIFIa.js";function m(){const{user:m,isAuthenticated:x,loading:h}=d(),{stands:u,loading:j}=i(),[g,p]=t.useState("Checking connection..."),[f,b]=t.useState(!0),[N,y]=t.useState(null),[v,w]=t.useState(!1),[S,E]=t.useState([]);return t.useEffect((()=>{!async function(){try{const{data:e,error:s}=await c.from("stands").select("count");s?(p("Connection failed"),y(s.message)):p("Connected to Supabase")}catch(e){p("Connection error"),y(e.message)}finally{b(!1)}}()}),[]),t.useEffect((()=>{if(!v)return;(async()=>{try{const{data:e,error:s}=await o();if(s)throw new Error(s.message);E(e||[])}catch(e){}})();const e=l((e=>{"INSERT"===e.eventType?E((s=>[...s,e.new])):"UPDATE"===e.eventType?E((s=>s.map((s=>s.id===e.new.id?e.new:s)))):"DELETE"===e.eventType&&E((s=>s.filter((s=>s.id!==e.old.id))))}));return()=>{r(e)}}),[v]),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-display text-lemonade-blue-dark mb-6",children:"Supabase Integration Test"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"p-6 bg-white rounded-xl shadow-md mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Connection Status"}),f?e.jsx(s,{size:"md",variant:"yellow"}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium "+(g.includes("failed")||g.includes("error")?"text-red-500":"text-green-500"),children:g}),N&&e.jsx(a,{variant:"error",className:"mt-2",children:N})]})]}),e.jsxs("div",{className:"p-6 bg-white rounded-xl shadow-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Authentication"}),e.jsx(n,{})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"p-6 bg-white rounded-xl shadow-md mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Stands from Context"}),j&&e.jsx(s,{size:"sm",variant:"yellow"})]}),u.length>0?e.jsx("ul",{className:"divide-y divide-gray-200",children:u.map((s=>e.jsxs("li",{className:"py-3",children:[e.jsx("h3",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.address})]},s.id)))}):j?null:e.jsx("p",{className:"text-gray-500",children:"No stands found"})]}),e.jsxs("div",{className:"p-6 bg-white rounded-xl shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Real-time Subscription"}),e.jsx("button",{className:"px-3 py-1 rounded text-sm "+(v?"bg-green-100 text-green-800 hover:bg-green-200":"bg-gray-100 text-gray-800 hover:bg-gray-200"),onClick:()=>w(!v),children:v?"Enabled":"Disabled"})]}),v?S.length>0?e.jsx("ul",{className:"divide-y divide-gray-200",children:S.map((s=>e.jsxs("li",{className:"py-3",children:[e.jsx("h3",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.address})]},s.id)))}):e.jsx("p",{className:"text-gray-500",children:"No stands found"}):e.jsx("p",{className:"text-gray-500",children:'Click "Disabled" to enable real-time updates'})]})]})]})]})}export{m as default};
//# sourceMappingURL=SupabaseTest-BbZyV13A.js.map
