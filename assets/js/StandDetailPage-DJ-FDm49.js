import{j as e,B as s,A as a,C as t,P as n,L as i,T as l,F as r,M as d}from"./vendor-ui-CJnRkr8k.js";import{a as o,h as c,d as m,L as x}from"./vendor-react-gkcTQpZ_.js";import{r as h,d as u,l as g,j as p,h as j,k as v,m as y,n as f}from"./index-DCJFINk2.js";import{M as b}from"./Map-CRQRxRTR.js";import{u as N,M as w,P as _,L as S}from"./vendor-leaflet-CnX7MzVf.js";import"./vendor-supabase-8AYXEB3l.js";const E=({stand:t,onExtend:n})=>{const[i,l]=o.useState(!1),[r,d]=o.useState(null),[c,m]=o.useState(null),[x,u]=o.useState(null),g=o.useRef(null),p=()=>{if(!t.expiration_time)return null;const e=new Date,s=new Date(t.expiration_time)-e;if(s<=0)return{expired:!0,timeString:"Expired"};const a=Math.floor(s/36e5),n=Math.floor(s%36e5/6e4),i=Math.floor(s%6e4/1e3);let l="";return a>0&&(l+=`${a} hour${1!==a?"s":""}`),(n>0||0===a)&&(a>0&&(l+=" and "),l+=`${n} minute${1!==n?"s":""}`),0===a&&0===n&&(l=`${i} second${1!==i?"s":""}`),{expired:!1,timeString:l,hours:a,minutes:n,seconds:i,critical:0===a&&n<30}};o.useEffect((()=>(u(p()),g.current=setInterval((()=>{const e=p();u(e),e&&e.expired&&clearInterval(g.current)}),1e3),()=>{g.current&&clearInterval(g.current)})),[t.expiration_time]);const j=async()=>{l(!0),d(null),m(null);try{const{data:e,error:s}=await h(t.id);if(s)throw new Error(s.message);const a=new Date,i=new Date(a);i.setHours(23,59,59,999);const l=Math.round((i-a)/36e5);m(`Stand reopened successfully! Active for the next ${l} hours (until midnight).`),n&&e&&n(e)}catch(e){d(e.message)}finally{l(!1)}};if(!t.expiration_time)return e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-yellow-800 mb-2",children:"This stand does not have an expiration time set."}),e.jsx(s,{variant:"secondary",onClick:j,disabled:i,size:"sm",children:i?"Setting expiration...":"Activate until midnight"})]});const v=e=>new Date(e).toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}),y=()=>{if(!t.expiration_time)return!1;const e=new Date,s=new Date(t.expiration_time);return e.getDate()===s.getDate()&&e.getMonth()===s.getMonth()&&e.getFullYear()===s.getFullYear()};return e.jsxs("div",{className:"rounded-lg p-4 mb-4 "+(x.expired?"bg-red-50 border border-red-200":x.critical?"bg-orange-50 border border-orange-200":"bg-blue-50 border border-blue-200"),children:[r&&e.jsx(a,{variant:"error",className:"mb-3",dismissible:!0,onDismiss:()=>d(null),children:r}),c&&e.jsx(a,{variant:"success",className:"mb-3",dismissible:!0,onDismiss:()=>m(null),children:c}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium "+(x.expired?"text-red-800":x.critical?"text-orange-800":"text-blue-800"),children:"Stand Visibility Status"}),x&&x.expired?e.jsx("p",{className:"text-red-600",children:"This stand has expired and is no longer visible to the public."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center "+(x&&x.critical?"text-orange-600":"text-blue-600"),children:[e.jsx("span",{className:"text-lg font-semibold mr-2",children:"Countdown:"}),e.jsx("div",{className:"bg-white rounded-lg px-3 py-2 shadow-sm border border-gray-200",children:e.jsx("span",{className:"font-mono text-lg",children:x?x.timeString:"Calculating..."})})]}),e.jsx("p",{className:"text-gray-600 text-sm mt-2",children:y()?`Expires tonight at midnight (${v(t.expiration_time)})`:`Expires at midnight: ${v(t.expiration_time)}`})]})]}),e.jsx(s,{variant:x&&x.expired?"primary":"secondary",onClick:j,disabled:i,className:"mt-3 md:mt-0",children:i?"Processing...":x&&x.expired?"Reopen Stand":y()?"Active Until Tonight":"Active Until Midnight"})]})]})},M=({statistics:s})=>{const a=s||{totalViews:Math.floor(500*Math.random()),uniqueVisitors:Math.floor(200*Math.random()),averageTimeSpent:Math.floor(5*Math.random())+1,popularTimes:[{day:"Monday",hour:"2-4 PM"},{day:"Wednesday",hour:"3-5 PM"},{day:"Saturday",hour:"12-2 PM"}],viewsByDay:[{day:"Mon",views:Math.floor(50*Math.random())},{day:"Tue",views:Math.floor(50*Math.random())},{day:"Wed",views:Math.floor(50*Math.random())},{day:"Thu",views:Math.floor(50*Math.random())},{day:"Fri",views:Math.floor(50*Math.random())},{day:"Sat",views:Math.floor(50*Math.random())},{day:"Sun",views:Math.floor(50*Math.random())}]},n=Math.max(...a.viewsByDay.map((e=>e.views)));return e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx("h3",{className:"text-blue-800 text-lg mb-1",children:"Total Views"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:a.totalViews})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[e.jsx("h3",{className:"text-green-800 text-lg mb-1",children:"Unique Visitors"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:a.uniqueVisitors})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[e.jsx("h3",{className:"text-purple-800 text-lg mb-1",children:"Avg. Time (min)"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:a.averageTimeSpent})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs(t,{children:[e.jsx(t.Header,{children:e.jsx("h3",{className:"text-xl font-display text-lemonade-blue-dark",children:"Views by Day"})}),e.jsx(t.Body,{className:"p-4",children:e.jsx("div",{className:"h-64 flex items-end justify-between",children:a.viewsByDay.map(((s,a)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-8 bg-lemonade-blue rounded-t-md",style:{height:s.views/n*100+"%",minHeight:"10px"}}),e.jsx("span",{className:"mt-2 text-sm text-gray-600",children:s.day})]},a)))})})]}),e.jsxs(t,{children:[e.jsx(t.Header,{children:e.jsx("h3",{className:"text-xl font-display text-lemonade-blue-dark",children:"Popular Times"})}),e.jsx(t.Body,{children:e.jsx("ul",{className:"divide-y divide-gray-200",children:a.popularTimes.map(((s,a)=>e.jsxs("li",{className:"py-3 flex justify-between",children:[e.jsx("span",{className:"font-medium",children:s.day}),e.jsx("span",{className:"text-gray-600",children:s.hour})]},a)))})})]})]}),e.jsx("div",{className:"p-4 bg-yellow-50 rounded-lg",children:e.jsx("p",{className:"text-yellow-800 text-sm",children:"Note: These statistics are for demonstration purposes only. In a production environment, this would be connected to real analytics data."})})]})},T=({position:s,onPositionChange:a,popupContent:t,icon:n,draggable:i=!0})=>{const l=o.useRef(null),r=N(),[d,c]=o.useState(s);o.useEffect((()=>{s&&s[0]&&s[1]&&c(s)}),[s]);const m={dragend(){const e=l.current;if(e){const s=e.getLatLng();c([s.lat,s.lng]),a&&a([s.lat,s.lng])}}};return o.useEffect((()=>{d&&d[0]&&d[1]&&r.setView(d,r.getZoom())}),[]),e.jsx(w,{draggable:i,eventHandlers:m,position:d,ref:l,icon:n,children:t&&e.jsx(_,{children:t})})};T.propTypes={position:n.arrayOf(n.number).isRequired,onPositionChange:n.func,popupContent:n.node,icon:n.instanceOf(S.Icon),draggable:n.bool};const D=()=>{const{id:n}=c(),h=m(),{user:N}=u(),[w,_]=o.useState(null),[S,D]=o.useState([]),[$,C]=o.useState(!0),[I,k]=o.useState(null),[L,P]=o.useState(null),[F,A]=o.useState("details"),[R,G]=o.useState(!1),[q,U]=o.useState(!1),[V,B]=o.useState(null),[z,O]=o.useState({name:"",description:"",address:"",location_lat:"",location_lng:"",is_active:!0}),[Y,H]=o.useState(null),[W,Z]=o.useState(null),[J,K]=o.useState(!1),[Q,X]=o.useState(!1),[ee,se]=o.useState(!1),[ae,te]=o.useState({totalViews:Math.floor(500*Math.random()),uniqueVisitors:Math.floor(200*Math.random()),averageTimeSpent:Math.floor(5*Math.random())+1,popularTimes:[{day:"Monday",hour:"2-4 PM"},{day:"Wednesday",hour:"3-5 PM"},{day:"Saturday",hour:"12-2 PM"}]});o.useEffect((()=>{N?(async()=>{try{if(C(!0),k(null),g.info("Fetching stand data",{standId:n}),!N||!N.id)throw g.error("Authentication error",new Error("User not available or missing ID"),{standId:n,userExists:!!N}),new Error("Authentication error. Please try logging in again.");g.apiRequest(`stands/${n}`,"GET");const{data:e,error:s}=await p(n);if(s)throw g.apiError(`stands/${n}`,"GET",s),new Error(`Failed to load stand: ${s.message}`);if(!e)throw g.warn("Stand not found",{standId:n}),new Error("Stand not found. It may have been deleted.");let a={...e};if("string"==typeof a.location_lat&&(a.location_lat=parseFloat(a.location_lat)||0),"string"==typeof a.location_lng&&(a.location_lng=parseFloat(a.location_lng)||0),g.apiResponse(`stands/${n}`,"GET",{standExists:!!a},200),a.owner_id!==N.id)throw g.warn("Permission denied",{standId:n,standOwnerId:a.owner_id,userId:N.id}),new Error("You do not have permission to view this stand");g.info("Stand data loaded successfully",{standId:n,standName:a.name,isActive:a.is_active}),_(a),O({name:a.name||"",description:a.description||"",address:a.address||"",location_lat:a.location_lat||"",location_lng:a.location_lng||"",is_active:a.is_active}),g.apiRequest(`products?standId=${n}`,"GET");const{data:t,error:i}=await j(n);i?(g.apiError(`products?standId=${n}`,"GET",i),g.warn("Failed to load products, continuing with empty products list",{error:i.message}),D([])):(g.apiResponse(`products?standId=${n}`,"GET",{productCount:(null==t?void 0:t.length)||0},200),D(t||[]))}catch(e){g.error("Error fetching stand data",e,{standId:n}),k(e.message||"Something went wrong. Please try again."),_(null)}finally{C(!1)}})():g.info("Waiting for user data before fetching stand",{standId:n})}),[n,N]);const ne=e=>{const{name:s,value:a,type:t,checked:n}=e.target;O((e=>({...e,[s]:"checkbox"===t?n:a})))};return $&&!w?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex flex-col justify-center items-center h-64",children:e.jsx(i,{size:"lg",variant:"blue",message:"Loading stand details..."})})}):I?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-4",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark mb-4",children:"Error Loading Stand"}),e.jsx(a,{variant:"error",className:"mb-6",dismissible:!0,onDismiss:()=>k(null),children:I}),e.jsx("p",{className:"text-gray-600 mb-6",children:"There was a problem loading the stand details. This could be due to:"}),e.jsxs("ul",{className:"list-disc list-inside text-gray-600 mb-6",children:[e.jsx("li",{children:"The stand may have been deleted"}),e.jsx("li",{children:"You may not have permission to view this stand"}),e.jsx("li",{children:"There might be a temporary server issue"}),e.jsx("li",{children:"Your session may have expired"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(x,{to:"/seller/dashboard",children:e.jsx(s,{variant:"primary",children:"Back to Dashboard"})}),e.jsx(s,{variant:"secondary",onClick:()=>window.location.reload(),children:"Try Again"})]})]})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row justify-between items-start md:items-center",children:[e.jsxs("div",{children:[e.jsx(x,{to:"/seller/dashboard",className:"text-lemonade-blue hover:underline mb-2 inline-block",children:"← Back to Dashboard"}),e.jsx("h1",{className:"text-3xl font-display text-lemonade-blue-dark",children:w.name})]}),e.jsxs("div",{className:"flex space-x-2 mt-4 md:mt-0",children:[e.jsxs(s,{variant:w.is_active?"danger-outline":"success",onClick:async()=>{C(!0),k(null),P(null);const e=!w.is_active,s=e?"activate":"deactivate";g.info(`Attempting to ${s} stand`,{standId:n,currentState:w.is_active,newState:e});try{g.apiRequest(`stands/${n}`,"PATCH",{is_active:e});const{data:a,error:t}=await v(n,{is_active:e});if(t)throw g.apiError(`stands/${n}`,"PATCH",t),new Error(`Failed to ${s} stand: ${t.message}`);g.apiResponse(`stands/${n}`,"PATCH",{success:!0},200),g.info(`Stand ${s}d successfully`,{standId:n}),_({...w,is_active:e}),O((s=>({...s,is_active:e}))),P(`Stand ${e?"activated":"deactivated"} successfully!`)}catch(a){g.error(`Error ${s}ing stand`,a,{standId:n}),k(a.message)}finally{C(!1)}},disabled:$,children:[w.is_active?"Deactivate":"Activate"," Stand"]}),e.jsx(s,{variant:"danger",onClick:()=>X(!0),children:"Delete Stand"})]})]}),I&&e.jsx(a,{variant:"error",className:"mb-4",dismissible:!0,onDismiss:()=>k(null),children:I}),L&&e.jsx(a,{variant:"success",className:"mb-4",dismissible:!0,onDismiss:()=>P(null),children:L}),e.jsx(E,{stand:w,onExtend:e=>{_(e)}}),e.jsx(l,{activeTab:F,onChange:A,tabs:[{id:"details",label:"Stand Details"},{id:"products",label:"Products"},{id:"statistics",label:"Visitor Statistics"}],className:"mb-6"}),"details"===F&&e.jsx("div",{className:"bg-white rounded-xl shadow-md p-6",children:R?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark",children:"Edit Stand Details"}),e.jsx(s,{variant:"secondary",onClick:()=>{G(!1),H(null),Z(null),O({name:w.name||"",description:w.description||"",address:w.address||"",location_lat:w.location_lat||"",location_lng:w.location_lng||"",is_active:w.is_active})},children:"Cancel"})]}),e.jsxs(r,{onSubmit:async e=>{e.preventDefault(),C(!0),k(null),P(null),g.info("Submitting stand update form",{standId:n,hasImageUpdate:!!Y});try{if(!z.name.trim())throw new Error("Stand name is required");g.apiRequest(`stands/${n}`,"PUT",{formData:{...z,name:z.name.trim()}});const{data:e,error:s}=await v(n,{...z,name:z.name.trim()});if(s)throw g.apiError(`stands/${n}`,"PUT",s),new Error(`Failed to update stand: ${s.message}`);if(g.apiResponse(`stands/${n}`,"PUT",{success:!0},200),Y){K(!0),g.info("Uploading stand image",{standId:n,imageSize:Y.size,imageType:Y.type}),g.apiRequest(`stands/${n}/image`,"POST");const{error:e}=await y(n,N.id,Y);if(e)throw g.apiError(`stands/${n}/image`,"POST",e),new Error(`Error uploading image: ${e.message}`);g.apiResponse(`stands/${n}/image`,"POST",{success:!0},200),g.apiRequest(`stands/${n}`,"GET");const{data:s,error:a}=await p(n);if(a)throw g.apiError(`stands/${n}`,"GET",a),new Error(`Error refreshing stand data: ${a.message}`);g.apiResponse(`stands/${n}`,"GET",{success:!0},200),_(s)}else _(e[0]);g.info("Stand updated successfully",{standId:n}),P("Stand updated successfully!"),G(!1),H(null),Z(null)}catch(s){g.error("Error updating stand",s,{standId:n}),k(s.message)}finally{C(!1),K(!1)}},children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("div",{className:"rounded-lg overflow-hidden border border-gray-200 mb-4",children:W?e.jsx("img",{src:W,alt:"Preview",className:"w-full h-64 object-cover"}):w.image_url?e.jsx("img",{src:w.image_url,alt:w.name,className:"w-full h-64 object-cover"}):e.jsx("div",{className:"w-full h-64 bg-lemonade-yellow-light flex items-center justify-center",children:e.jsx("span",{className:"text-lemonade-yellow-dark",children:"No Image"})})}),e.jsxs(r.Group,{children:[e.jsx(r.Label,{htmlFor:"image",children:"Stand Image"}),e.jsx(r.Input,{id:"image",name:"image",type:"file",accept:"image/*",onChange:e=>{const s=e.target.files[0];if(s){H(s);const e=new FileReader;e.onloadend=()=>{Z(e.result)},e.readAsDataURL(s)}}}),e.jsx(r.Text,{children:"Upload an image of your lemonade stand."})]}),e.jsxs(r.Group,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(r.Checkbox,{id:"is_active",name:"is_active",checked:z.is_active,onChange:ne}),e.jsx(r.Label,{htmlFor:"is_active",className:"ml-2 mb-0",children:"Stand is active"})]}),e.jsx(r.Text,{children:"Inactive stands are not visible to the public."})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs(r.Group,{children:[e.jsx(r.Label,{htmlFor:"name",required:!0,children:"Stand Name"}),e.jsx(r.Input,{id:"name",name:"name",value:z.name,onChange:ne,placeholder:"Enter stand name",required:!0})]}),e.jsxs(r.Group,{children:[e.jsx(r.Label,{htmlFor:"description",children:"Description"}),e.jsx(r.Textarea,{id:"description",name:"description",value:z.description,onChange:ne,placeholder:"Describe your lemonade stand",rows:4})]}),e.jsxs(r.Group,{children:[e.jsx(r.Label,{htmlFor:"address",children:"Address"}),e.jsx(r.Input,{id:"address",name:"address",value:z.address,onChange:ne,placeholder:"Enter stand address"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(r.Group,{children:[e.jsx(r.Label,{htmlFor:"location_lat",children:"Latitude"}),e.jsx(r.Input,{id:"location_lat",name:"location_lat",type:"number",step:"any",value:z.location_lat,onChange:ne,placeholder:"Enter latitude"})]}),e.jsxs(r.Group,{children:[e.jsx(r.Label,{htmlFor:"location_lng",children:"Longitude"}),e.jsx(r.Input,{id:"location_lng",name:"location_lng",type:"number",step:"any",value:z.location_lng,onChange:ne,placeholder:"Enter longitude"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(s,{type:"button",variant:"secondary",onClick:()=>{w&&w.location_lat&&w.location_lng?B([w.location_lat,w.location_lng]):z.location_lat&&z.location_lng?B([parseFloat(z.location_lat),parseFloat(z.location_lng)]):B([39.8283,-98.5795]),U(!0)},className:"w-full flex items-center justify-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),"Set Location on Map (Drag & Drop)"]})})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx(s,{type:"submit",variant:"primary",disabled:$||J,children:$||J?"Saving...":"Save Changes"})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark",children:"Stand Details"}),e.jsx(s,{variant:"primary",onClick:()=>G(!0),children:"Edit Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsx("div",{className:"rounded-lg overflow-hidden border border-gray-200",children:w.image_url?e.jsx("img",{src:w.image_url,alt:w.name,className:"w-full h-64 object-cover"}):e.jsx("div",{className:"w-full h-64 bg-lemonade-yellow-light flex items-center justify-center",children:e.jsx("span",{className:"text-lemonade-yellow-dark",children:"No Image"})})})}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Name"}),e.jsx("p",{className:"text-gray-800 font-medium",children:w.name})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Status"}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(w.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:w.is_active?"Active":"Inactive"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Description"}),e.jsx("p",{className:"text-gray-800",children:w.description||"No description provided."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Address"}),e.jsx("p",{className:"text-gray-800",children:w.address||"No address provided."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Latitude"}),e.jsx("p",{className:"text-gray-800 font-mono",children:w.location_lat||"N/A"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Longitude"}),e.jsx("p",{className:"text-gray-800 font-mono",children:w.location_lng||"N/A"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Created"}),e.jsx("p",{className:"text-gray-800",children:new Date(w.created_at).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Last Updated"}),e.jsx("p",{className:"text-gray-800",children:new Date(w.updated_at).toLocaleDateString()})]})]})})]})]})}),"products"===F&&e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark",children:"Products"}),e.jsx(x,{to:`/seller/stands/${n}/products/new`,children:e.jsx(s,{variant:"primary",children:"Add New Product"})})]}),0===S.length?e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"You don't have any products for this stand yet."}),e.jsx(x,{to:`/seller/stands/${n}/products/new`,children:e.jsx(s,{variant:"primary",children:"Add Your First Product"})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map((s=>e.jsxs(t,{className:"hover:shadow-md transition",children:[e.jsx("div",{className:"h-48 bg-gray-100",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-lemonade-yellow-light flex items-center justify-center",children:e.jsx("span",{className:"text-lemonade-yellow-dark",children:"No Image"})})}),e.jsxs(t.Body,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-xl font-display text-lemonade-blue-dark",children:s.name}),e.jsxs("span",{className:"text-lg font-semibold text-lemonade-blue",children:["$",s.price.toFixed(2)]})]}),e.jsx("p",{className:"text-gray-600 mb-3 line-clamp-2",children:s.description||"No description"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(s.is_available?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:s.is_available?"Available":"Unavailable"}),e.jsx(x,{to:`/seller/stands/${n}/products/${s.id}`,className:"text-lemonade-blue hover:underline",children:"Edit →"})]})]})]},s.id)))})]}),"statistics"===F&&e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark mb-6",children:"Visitor Statistics"}),e.jsx(M,{statistics:ae})]}),e.jsx(d,{isOpen:Q,onClose:()=>X(!1),title:"Delete Stand",children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-700 mb-6",children:"Are you sure you want to delete this stand? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(s,{variant:"secondary",onClick:()=>X(!1),disabled:ee,children:"Cancel"}),e.jsx(s,{variant:"danger",onClick:async()=>{se(!0),k(null),g.info("Deleting stand",{standId:n});try{if(!w||w.owner_id!==N.id)throw g.warn("Unauthorized deletion attempt",{standId:n,userId:N.id,standOwnerId:null==w?void 0:w.owner_id}),new Error("You do not have permission to delete this stand");g.apiRequest(`stands/${n}`,"DELETE");const{error:e}=await f(n);if(e)throw g.apiError(`stands/${n}`,"DELETE",e),new Error(`Failed to delete stand: ${e.message}`);g.apiResponse(`stands/${n}`,"DELETE",{success:!0},200),g.info("Stand deleted successfully",{standId:n}),h("/seller/dashboard",{state:{message:"Stand deleted successfully!"}})}catch(e){g.error("Error deleting stand",e,{standId:n}),k(e.message),X(!1)}finally{se(!1)}},disabled:ee,children:ee?"Deleting...":"Delete Stand"})]})]})}),q&&e.jsx(d,{isOpen:q,onClose:()=>U(!1),title:"Adjust Stand Location",size:"lg",children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"mb-4 text-gray-700",children:"Drag the marker to set your stand's exact location. Click \"Save Location\" when you're done."}),e.jsx("div",{className:"h-96 mb-4 rounded-lg overflow-hidden",children:V&&e.jsx(b,{center:V,zoom:15,height:"100%",showUserLocation:!0,children:e.jsx(T,{position:V,onPositionChange:e=>{O((s=>({...s,location_lat:e[0],location_lng:e[1]})))},popupContent:e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-base",children:"Your Stand Location"}),e.jsx("p",{className:"text-sm",children:"Drag me to adjust!"})]})})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),e.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded-md",value:z.location_lat,onChange:e=>O((s=>({...s,location_lat:e.target.value})))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),e.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded-md",value:z.location_lng,onChange:e=>O((s=>({...s,location_lng:e.target.value})))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(s,{variant:"secondary",onClick:()=>U(!1),children:"Cancel"}),e.jsx(s,{variant:"primary",onClick:()=>U(!1),children:"Save Location"})]})]})})]})};export{D as default};
//# sourceMappingURL=StandDetailPage-DJ-FDm49.js.map
