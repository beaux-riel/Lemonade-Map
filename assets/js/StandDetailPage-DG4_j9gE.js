import{j as e,B as s,A as a,C as t,T as l,F as i,M as r}from"./vendor-ui-Db6t6WVF.js";import{r as n,f as d,u as c,L as o}from"./vendor-react-CDe1t649.js";import{h as m,d as x,i as h,j as u,k as j,l as g,m as p}from"./index-BtuY4TKD.js";import"./vendor-supabase-BUo_ywwZ.js";const v=({stand:t,onExtend:l})=>{const[i,r]=n.useState(!1),[d,c]=n.useState(null),[o,x]=n.useState(null),h=(()=>{if(!t.expiration_time)return null;const e=new Date,s=new Date(t.expiration_time)-e;if(s<=0)return{expired:!0,timeString:"Expired"};const a=Math.floor(s/36e5),l=Math.floor(s%36e5/6e4);let i="";return a>0&&(i+=`${a} hour${1!==a?"s":""}`),(l>0||0===a)&&(a>0&&(i+=" and "),i+=`${l} minute${1!==l?"s":""}`),{expired:!1,timeString:i,hours:a,minutes:l,critical:0===a&&l<30}})(),u=async()=>{r(!0),c(null),x(null);try{const{data:e,error:s}=await m(t.id);if(s)throw new Error(s.message);x("Stand expiration extended successfully!"),l&&e&&l(e[0])}catch(e){c(e.message)}finally{r(!1)}};return t.expiration_time?e.jsxs("div",{className:"rounded-lg p-4 mb-4 "+(h.expired?"bg-red-50 border border-red-200":h.critical?"bg-orange-50 border border-orange-200":"bg-blue-50 border border-blue-200"),children:[d&&e.jsx(a,{variant:"error",className:"mb-3",dismissible:!0,onDismiss:()=>c(null),children:d}),o&&e.jsx(a,{variant:"success",className:"mb-3",dismissible:!0,onDismiss:()=>x(null),children:o}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium "+(h.expired?"text-red-800":h.critical?"text-orange-800":"text-blue-800"),children:"Stand Visibility Status"}),e.jsx("p",{className:""+(h.expired?"text-red-600":h.critical?"text-orange-600":"text-blue-600"),children:h.expired?"This stand has expired and is no longer visible to the public.":`Time remaining: ${h.timeString}`}),!h.expired&&e.jsxs("p",{className:"text-gray-600 text-sm mt-1",children:["Expires on: ",new Date(t.expiration_time).toLocaleString()]})]}),e.jsx(s,{variant:h.expired?"primary":"secondary",onClick:u,disabled:i,className:"mt-3 md:mt-0",children:i?"Extending...":h.expired?"Reactivate Stand":"Extend by 24 Hours"})]})]}):e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-yellow-800 mb-2",children:"This stand does not have an expiration time set."}),e.jsx(s,{variant:"secondary",onClick:u,disabled:i,size:"sm",children:i?"Setting expiration...":"Set 24-hour expiration"})]})},y=({statistics:s})=>{const a=s||{totalViews:Math.floor(500*Math.random()),uniqueVisitors:Math.floor(200*Math.random()),averageTimeSpent:Math.floor(5*Math.random())+1,popularTimes:[{day:"Monday",hour:"2-4 PM"},{day:"Wednesday",hour:"3-5 PM"},{day:"Saturday",hour:"12-2 PM"}],viewsByDay:[{day:"Mon",views:Math.floor(50*Math.random())},{day:"Tue",views:Math.floor(50*Math.random())},{day:"Wed",views:Math.floor(50*Math.random())},{day:"Thu",views:Math.floor(50*Math.random())},{day:"Fri",views:Math.floor(50*Math.random())},{day:"Sat",views:Math.floor(50*Math.random())},{day:"Sun",views:Math.floor(50*Math.random())}]},l=Math.max(...a.viewsByDay.map((e=>e.views)));return e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx("h3",{className:"text-blue-800 text-lg mb-1",children:"Total Views"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:a.totalViews})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[e.jsx("h3",{className:"text-green-800 text-lg mb-1",children:"Unique Visitors"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:a.uniqueVisitors})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[e.jsx("h3",{className:"text-purple-800 text-lg mb-1",children:"Avg. Time (min)"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:a.averageTimeSpent})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs(t,{children:[e.jsx(t.Header,{children:e.jsx("h3",{className:"text-xl font-display text-lemonade-blue-dark",children:"Views by Day"})}),e.jsx(t.Body,{className:"p-4",children:e.jsx("div",{className:"h-64 flex items-end justify-between",children:a.viewsByDay.map(((s,a)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-8 bg-lemonade-blue rounded-t-md",style:{height:s.views/l*100+"%",minHeight:"10px"}}),e.jsx("span",{className:"mt-2 text-sm text-gray-600",children:s.day})]},a)))})})]}),e.jsxs(t,{children:[e.jsx(t.Header,{children:e.jsx("h3",{className:"text-xl font-display text-lemonade-blue-dark",children:"Popular Times"})}),e.jsx(t.Body,{children:e.jsx("ul",{className:"divide-y divide-gray-200",children:a.popularTimes.map(((s,a)=>e.jsxs("li",{className:"py-3 flex justify-between",children:[e.jsx("span",{className:"font-medium",children:s.day}),e.jsx("span",{className:"text-gray-600",children:s.hour})]},a)))})})]})]}),e.jsx("div",{className:"p-4 bg-yellow-50 rounded-lg",children:e.jsx("p",{className:"text-yellow-800 text-sm",children:"Note: These statistics are for demonstration purposes only. In a production environment, this would be connected to real analytics data."})})]})},b=()=>{const{id:m}=d(),b=c(),{user:N}=x(),[f,w]=n.useState(null),[S,_]=n.useState([]),[M,D]=n.useState(!0),[k,E]=n.useState(null),[C,T]=n.useState(null),[L,F]=n.useState("details"),[A,I]=n.useState(!1),[P,V]=n.useState({name:"",description:"",address:"",location_lat:"",location_lng:"",is_active:!0}),[$,B]=n.useState(null),[G,q]=n.useState(null),[U,H]=n.useState(!1),[R,W]=n.useState(!1),[Y,z]=n.useState(!1),[O,J]=n.useState({totalViews:Math.floor(500*Math.random()),uniqueVisitors:Math.floor(200*Math.random()),averageTimeSpent:Math.floor(5*Math.random())+1,popularTimes:[{day:"Monday",hour:"2-4 PM"},{day:"Wednesday",hour:"3-5 PM"},{day:"Saturday",hour:"12-2 PM"}]});n.useEffect((()=>{(async()=>{try{D(!0);const{data:e,error:s}=await h(m);if(s)throw new Error(s.message);if(!e)throw new Error("Stand not found");if(e.owner_id!==N.id)throw new Error("You do not have permission to view this stand");w(e),V({name:e.name||"",description:e.description||"",address:e.address||"",location_lat:e.location_lat||"",location_lng:e.location_lng||"",is_active:e.is_active});const{data:a,error:t}=await u(m);if(t)throw new Error(t.message);_(a||[])}catch(e){E(e.message)}finally{D(!1)}})()}),[m,N.id]);const K=e=>{const{name:s,value:a,type:t,checked:l}=e.target;V((e=>({...e,[s]:"checkbox"===t?l:a})))};return M&&!f?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-lemonade-blue"})})}):k&&!f?e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx(a,{variant:"error",className:"mb-4",children:k}),e.jsx(o,{to:"/seller/dashboard",children:e.jsx(s,{variant:"secondary",children:"Back to Dashboard"})})]}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row justify-between items-start md:items-center",children:[e.jsxs("div",{children:[e.jsx(o,{to:"/seller/dashboard",className:"text-lemonade-blue hover:underline mb-2 inline-block",children:"← Back to Dashboard"}),e.jsx("h1",{className:"text-3xl font-display text-lemonade-blue-dark",children:f.name})]}),e.jsxs("div",{className:"flex space-x-2 mt-4 md:mt-0",children:[e.jsxs(s,{variant:f.is_active?"danger-outline":"success",onClick:async()=>{D(!0),E(null),T(null);try{const e=!f.is_active,{data:s,error:a}=await j(m,{is_active:e});if(a)throw new Error(a.message);w({...f,is_active:e}),V((s=>({...s,is_active:e}))),T(`Stand ${e?"activated":"deactivated"} successfully!`)}catch(e){E(e.message)}finally{D(!1)}},disabled:M,children:[f.is_active?"Deactivate":"Activate"," Stand"]}),e.jsx(s,{variant:"danger",onClick:()=>W(!0),children:"Delete Stand"})]})]}),k&&e.jsx(a,{variant:"error",className:"mb-4",dismissible:!0,onDismiss:()=>E(null),children:k}),C&&e.jsx(a,{variant:"success",className:"mb-4",dismissible:!0,onDismiss:()=>T(null),children:C}),e.jsx(v,{stand:f,onExtend:e=>{w(e)}}),e.jsx(l,{activeTab:L,onChange:F,tabs:[{id:"details",label:"Stand Details"},{id:"products",label:"Products"},{id:"statistics",label:"Visitor Statistics"}],className:"mb-6"}),"details"===L&&e.jsx("div",{className:"bg-white rounded-xl shadow-md p-6",children:A?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark",children:"Edit Stand Details"}),e.jsx(s,{variant:"secondary",onClick:()=>{I(!1),B(null),q(null),V({name:f.name||"",description:f.description||"",address:f.address||"",location_lat:f.location_lat||"",location_lng:f.location_lng||"",is_active:f.is_active})},children:"Cancel"})]}),e.jsxs(i,{onSubmit:async e=>{e.preventDefault(),D(!0),E(null),T(null);try{const{data:e,error:s}=await j(m,P);if(s)throw new Error(s.message);if($){H(!0);const{error:e}=await g(m,N.id,$);if(e)throw new Error(`Error uploading image: ${e.message}`);const{data:s,error:a}=await h(m);if(a)throw new Error(a.message);w(s)}else w(e[0]);T("Stand updated successfully!"),I(!1),B(null),q(null)}catch(s){E(s.message)}finally{D(!1),H(!1)}},children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("div",{className:"rounded-lg overflow-hidden border border-gray-200 mb-4",children:G?e.jsx("img",{src:G,alt:"Preview",className:"w-full h-64 object-cover"}):f.image_url?e.jsx("img",{src:f.image_url,alt:f.name,className:"w-full h-64 object-cover"}):e.jsx("div",{className:"w-full h-64 bg-lemonade-yellow-light flex items-center justify-center",children:e.jsx("span",{className:"text-lemonade-yellow-dark",children:"No Image"})})}),e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"image",children:"Stand Image"}),e.jsx(i.Input,{id:"image",name:"image",type:"file",accept:"image/*",onChange:e=>{const s=e.target.files[0];if(s){B(s);const e=new FileReader;e.onloadend=()=>{q(e.result)},e.readAsDataURL(s)}}}),e.jsx(i.Text,{children:"Upload an image of your lemonade stand."})]}),e.jsxs(i.Group,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(i.Checkbox,{id:"is_active",name:"is_active",checked:P.is_active,onChange:K}),e.jsx(i.Label,{htmlFor:"is_active",className:"ml-2 mb-0",children:"Stand is active"})]}),e.jsx(i.Text,{children:"Inactive stands are not visible to the public."})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"name",required:!0,children:"Stand Name"}),e.jsx(i.Input,{id:"name",name:"name",value:P.name,onChange:K,placeholder:"Enter stand name",required:!0})]}),e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"description",children:"Description"}),e.jsx(i.Textarea,{id:"description",name:"description",value:P.description,onChange:K,placeholder:"Describe your lemonade stand",rows:4})]}),e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"address",children:"Address"}),e.jsx(i.Input,{id:"address",name:"address",value:P.address,onChange:K,placeholder:"Enter stand address"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"location_lat",children:"Latitude"}),e.jsx(i.Input,{id:"location_lat",name:"location_lat",type:"number",step:"any",value:P.location_lat,onChange:K,placeholder:"Enter latitude"})]}),e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"location_lng",children:"Longitude"}),e.jsx(i.Input,{id:"location_lng",name:"location_lng",type:"number",step:"any",value:P.location_lng,onChange:K,placeholder:"Enter longitude"})]})]})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx(s,{type:"submit",variant:"primary",disabled:M||U,children:M||U?"Saving...":"Save Changes"})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark",children:"Stand Details"}),e.jsx(s,{variant:"primary",onClick:()=>I(!0),children:"Edit Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsx("div",{className:"rounded-lg overflow-hidden border border-gray-200",children:f.image_url?e.jsx("img",{src:f.image_url,alt:f.name,className:"w-full h-64 object-cover"}):e.jsx("div",{className:"w-full h-64 bg-lemonade-yellow-light flex items-center justify-center",children:e.jsx("span",{className:"text-lemonade-yellow-dark",children:"No Image"})})})}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Name"}),e.jsx("p",{className:"text-gray-800 font-medium",children:f.name})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Status"}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(f.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:f.is_active?"Active":"Inactive"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Description"}),e.jsx("p",{className:"text-gray-800",children:f.description||"No description provided."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Address"}),e.jsx("p",{className:"text-gray-800",children:f.address||"No address provided."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Latitude"}),e.jsx("p",{className:"text-gray-800 font-mono",children:f.location_lat||"N/A"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Longitude"}),e.jsx("p",{className:"text-gray-800 font-mono",children:f.location_lng||"N/A"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Created"}),e.jsx("p",{className:"text-gray-800",children:new Date(f.created_at).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Last Updated"}),e.jsx("p",{className:"text-gray-800",children:new Date(f.updated_at).toLocaleDateString()})]})]})})]})]})}),"products"===L&&e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark",children:"Products"}),e.jsx(o,{to:`/seller/stands/${m}/products/new`,children:e.jsx(s,{variant:"primary",children:"Add New Product"})})]}),0===S.length?e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"You don't have any products for this stand yet."}),e.jsx(o,{to:`/seller/stands/${m}/products/new`,children:e.jsx(s,{variant:"primary",children:"Add Your First Product"})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map((s=>e.jsxs(t,{className:"hover:shadow-md transition",children:[e.jsx("div",{className:"h-48 bg-gray-100",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-lemonade-yellow-light flex items-center justify-center",children:e.jsx("span",{className:"text-lemonade-yellow-dark",children:"No Image"})})}),e.jsxs(t.Body,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-xl font-display text-lemonade-blue-dark",children:s.name}),e.jsxs("span",{className:"text-lg font-semibold text-lemonade-blue",children:["$",s.price.toFixed(2)]})]}),e.jsx("p",{className:"text-gray-600 mb-3 line-clamp-2",children:s.description||"No description"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(s.is_available?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:s.is_available?"Available":"Unavailable"}),e.jsx(o,{to:`/seller/stands/${m}/products/${s.id}`,className:"text-lemonade-blue hover:underline",children:"Edit →"})]})]})]},s.id)))})]}),"statistics"===L&&e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark mb-6",children:"Visitor Statistics"}),e.jsx(y,{statistics:O})]}),e.jsx(r,{isOpen:R,onClose:()=>W(!1),title:"Delete Stand",children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-700 mb-6",children:"Are you sure you want to delete this stand? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(s,{variant:"secondary",onClick:()=>W(!1),disabled:Y,children:"Cancel"}),e.jsx(s,{variant:"danger",onClick:async()=>{z(!0);try{const{error:e}=await p(m);if(e)throw new Error(e.message);b("/seller/dashboard",{state:{message:"Stand deleted successfully!"}})}catch(e){E(e.message),W(!1)}finally{z(!1)}},disabled:Y,children:Y?"Deleting...":"Delete Stand"})]})]})})]})};export{b as default};
//# sourceMappingURL=StandDetailPage-DG4_j9gE.js.map
