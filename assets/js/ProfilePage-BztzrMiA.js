import{j as e,b as a,C as l,d as s,T as t,A as r,F as i,B as o,e as n}from"./vendor-ui-OD4vbIQ8.js";import{d,r as u}from"./vendor-react-qVBsGM6v.js";import{H as c}from"./Helmet-InnD19tc.js";import{d as m,v as h,w as b,x as v,y as x}from"./index-DUP0hdrm.js";import{v as p,a as g}from"./validation-C0j_3j3c.js";import"./vendor-supabase-Dv6Edu65.js";const f=[{value:"AL",label:"Alabama"},{value:"AK",label:"Alaska"},{value:"AZ",label:"Arizona"},{value:"AR",label:"Arkansas"},{value:"CA",label:"California"},{value:"CO",label:"Colorado"},{value:"CT",label:"Connecticut"},{value:"DE",label:"Delaware"},{value:"FL",label:"Florida"},{value:"GA",label:"Georgia"},{value:"HI",label:"Hawaii"},{value:"ID",label:"Idaho"},{value:"IL",label:"Illinois"},{value:"IN",label:"Indiana"},{value:"IA",label:"Iowa"},{value:"KS",label:"Kansas"},{value:"KY",label:"Kentucky"},{value:"LA",label:"Louisiana"},{value:"ME",label:"Maine"},{value:"MD",label:"Maryland"},{value:"MA",label:"Massachusetts"},{value:"MI",label:"Michigan"},{value:"MN",label:"Minnesota"},{value:"MS",label:"Mississippi"},{value:"MO",label:"Missouri"},{value:"MT",label:"Montana"},{value:"NE",label:"Nebraska"},{value:"NV",label:"Nevada"},{value:"NH",label:"New Hampshire"},{value:"NJ",label:"New Jersey"},{value:"NM",label:"New Mexico"},{value:"NY",label:"New York"},{value:"NC",label:"North Carolina"},{value:"ND",label:"North Dakota"},{value:"OH",label:"Ohio"},{value:"OK",label:"Oklahoma"},{value:"OR",label:"Oregon"},{value:"PA",label:"Pennsylvania"},{value:"RI",label:"Rhode Island"},{value:"SC",label:"South Carolina"},{value:"SD",label:"South Dakota"},{value:"TN",label:"Tennessee"},{value:"TX",label:"Texas"},{value:"UT",label:"Utah"},{value:"VT",label:"Vermont"},{value:"VA",label:"Virginia"},{value:"WA",label:"Washington"},{value:"WV",label:"West Virginia"},{value:"WI",label:"Wisconsin"},{value:"WY",label:"Wyoming"},{value:"DC",label:"District of Columbia"}],j=[{value:"United States",label:"United States"},{value:"Canada",label:"Canada"},{value:"Mexico",label:"Mexico"},{value:"United Kingdom",label:"United Kingdom"},{value:"Australia",label:"Australia"},{value:"Other",label:"Other"}],y=()=>{const{user:y,isAuthenticated:N}=m(),w=d(),[C,S]=u.useState("personal"),[M,A]=u.useState(!0),[F,I]=u.useState(!1),[L,k]=u.useState(null),[z,P]=u.useState(null),[_,D]=u.useState(null),[G,T]=u.useState(null),[U,O]=u.useState({full_name:"",email:"",phone:"",bio:""}),[E,W]=u.useState({street:"",city:"",state:"",postalCode:"",country:"United States",useForSearch:!1}),[H,K]=u.useState({}),[Y,V]=u.useState({});u.useEffect((()=>{if(!N)return void w("/login",{state:{from:"/profile"}});(async()=>{var e,a;try{A(!0);const{data:l,error:s}=await h(y.id);if(s)throw new Error(s.message);l&&(O({full_name:l.full_name||"",email:y.email||"",phone:l.phone||"",bio:l.bio||""}),W({street:l.street||"",city:l.city||"",state:l.state||"",postalCode:l.postal_code||"",country:l.country||"United States",useForSearch:(null==(a=null==(e=l.preferences)?void 0:e.defaultSearchLocation)?void 0:a.useForSearch)||!1}),l.avatar_url&&T(l.avatar_url))}catch(l){k(l.message)}finally{A(!1)}})()}),[N,w,y]);const B=e=>{const{name:a,value:l}=e.target;O((e=>({...e,[a]:l}))),H[a]&&K((e=>({...e,[a]:null})))},R=e=>{const{name:a,value:l}=e.target;W((e=>({...e,[a]:l}))),Y[a]&&V((e=>({...e,[a]:null})))};return M?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(a,{size:"lg",variant:"yellow",message:"Loading your profile..."})}):e.jsxs("div",{className:"py-12 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-lemonade-yellow-light to-white",children:[e.jsxs(c,{children:[e.jsx("title",{children:"My Profile | Lemonade Map"}),e.jsx("meta",{name:"description",content:"Update your Lemonade Map profile and preferences"})]}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-display text-lemonade-blue-dark mb-4",children:"My Lemonade Profile"}),e.jsx("div",{className:"w-24 h-2 bg-lemonade-yellow mx-auto rounded-full mb-6"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Customize your profile and preferences to get the most out of your Lemonade Map experience!"})]}),e.jsxs(l,{className:"shadow-playful-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-lemonade-blue-light p-6 flex flex-col items-center",children:[e.jsxs("div",{className:"relative group",children:[e.jsx(s,{src:G,alt:U.full_name||"User",size:"xl",className:"border-4 border-white shadow-lg"}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 rounded-full opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",children:[e.jsx("label",{htmlFor:"avatar-upload",className:"text-white text-sm font-medium cursor-pointer",children:"Change"}),e.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",className:"hidden",onChange:e=>{const a=e.target.files[0];if(!a)return;if(!["image/jpeg","image/png","image/gif","image/webp"].includes(a.type))return void k("Please upload a valid image file (JPEG, PNG, GIF, or WebP)");if(a.size>5242880)return void k("Image file is too large. Maximum size is 5MB.");const l=new FileReader;l.onloadend=()=>{T(l.result)},l.readAsDataURL(a),D(a),k(null)}})]})]}),e.jsx("h2",{className:"mt-4 text-2xl font-display text-lemonade-blue-dark",children:U.full_name||"Your Profile"}),e.jsx("p",{className:"text-lemonade-blue-dark opacity-75",children:U.email})]}),e.jsx(t,{tabs:[{id:"personal",label:"Personal Info"},{id:"address",label:"Address"}],activeTab:C,onChange:S,className:"px-6 pt-4"}),e.jsxs(l.Body,{children:[L&&e.jsx(r,{type:"error",message:L,className:"mb-6",onClose:()=>k(null)}),z&&e.jsx(r,{type:"success",message:z,className:"mb-6",onClose:()=>P(null)}),"personal"===C&&e.jsx(i,{onSubmit:async e=>{e.preventDefault();const a=p(U);if(K(a),!(Object.keys(a).length>0))try{I(!0),k(null),P(null);const{error:e}=await b(y.id,{full_name:U.full_name,phone:U.phone,bio:U.bio});if(e)throw new Error(e.message);if(_){const{error:e}=await v(y.id,_);if(e)throw new Error(e.message)}P("Profile updated successfully!"),D(null)}catch(l){k(l.message)}finally{I(!1)}},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"full_name",required:!0,children:"Full Name"}),e.jsx(i.Input,{id:"full_name",name:"full_name",value:U.full_name,onChange:B,placeholder:"Your full name",error:H.full_name})]}),e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"email",children:"Email Address"}),e.jsx(i.Input,{id:"email",name:"email",type:"email",value:U.email,disabled:!0,className:"bg-gray-100"}),e.jsx(i.Text,{children:"Email cannot be changed. Contact support if needed."})]}),e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"phone",children:"Phone Number"}),e.jsx(i.Input,{id:"phone",name:"phone",value:U.phone,onChange:B,placeholder:"Your phone number (optional)",error:H.phone})]}),e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"bio",children:"Bio"}),e.jsx(i.Textarea,{id:"bio",name:"bio",value:U.bio,onChange:B,placeholder:"Tell us a bit about yourself...",rows:4,error:H.bio})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(o,{type:"submit",variant:"primary",size:"lg",disabled:F,children:F?e.jsxs(e.Fragment,{children:[e.jsx(a,{size:"sm",variant:"white",className:"mr-2"}),"Saving..."]}):"Save Profile"})})]})}),"address"===C&&e.jsx(i,{onSubmit:async e=>{e.preventDefault();const a=g(E);if(V(a),!(Object.keys(a).length>0))try{I(!0),k(null),P(null);const{error:e}=await x(y.id,E);if(e)throw new Error(e.message);P("Address updated successfully!")}catch(l){k(l.message)}finally{I(!1)}},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"street",children:"Street Address"}),e.jsx(i.Input,{id:"street",name:"street",value:E.street,onChange:R,placeholder:"123 Main St",error:Y.street})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"city",children:"City"}),e.jsx(i.Input,{id:"city",name:"city",value:E.city,onChange:R,placeholder:"Your city",error:Y.city})]}),e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"state",children:"State/Province"}),e.jsx(i.Select,{id:"state",name:"state",value:E.state,onChange:R,options:f,placeholder:"Select state",error:Y.state})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"postalCode",children:"ZIP/Postal Code"}),e.jsx(i.Input,{id:"postalCode",name:"postalCode",value:E.postalCode,onChange:R,placeholder:"12345",error:Y.postalCode})]}),e.jsxs(i.Group,{children:[e.jsx(i.Label,{htmlFor:"country",children:"Country"}),e.jsx(i.Select,{id:"country",name:"country",value:E.country,onChange:R,options:j,error:Y.country})]})]}),e.jsx("div",{className:"bg-lemonade-yellow-light p-4 rounded-lg border border-lemonade-yellow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-lemonade-blue-dark text-lg",children:"Use as Default Search Location"}),e.jsx("p",{className:"text-sm text-gray-600",children:"When enabled, we'll use this address as your default location when searching for lemonade stands."})]}),e.jsx(n,{checked:E.useForSearch,onChange:e=>{W((a=>({...a,useForSearch:e})))},label:"",srLabel:"Use address as default search location"})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(o,{type:"submit",variant:"primary",size:"lg",disabled:F,children:F?e.jsxs(e.Fragment,{children:[e.jsx(a,{size:"sm",variant:"white",className:"mr-2"}),"Saving..."]}):"Save Address"})})]})})]})]}),e.jsxs("div",{className:"relative mt-12",children:[e.jsx("div",{className:"absolute -top-16 -left-8 w-16 h-16 text-lemonade-yellow opacity-30 transform rotate-12",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-5-9h10v2H7z"})})}),e.jsx("div",{className:"absolute -bottom-8 -right-8 w-20 h-20 text-lemonade-pink opacity-20 transform -rotate-12",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-5-9h10v2H7z"})})})]})]})]})};export{y as default};
//# sourceMappingURL=ProfilePage-BztzrMiA.js.map
