import{j as e,L as a,C as l,b as s,A as r,T as t,F as n,B as i,c as o}from"./vendor-ui-CYdTg3fb.js";import{c as u,a as d}from"./vendor-react-CGzs7eOH.js";import{H as c}from"./Helmet-BxbNrjXF.js";import{u as m,h,i as b,j as v,k as p}from"./index-B-VvlpIu.js";import{v as x,a as j}from"./validation-C0j_3j3c.js";import"./vendor-leaflet-DNyTttW1.js";import"./vendor-supabase-CS0gIFIa.js";const g=[{value:"AL",label:"Alabama"},{value:"AK",label:"Alaska"},{value:"AZ",label:"Arizona"},{value:"AR",label:"Arkansas"},{value:"CA",label:"California"},{value:"CO",label:"Colorado"},{value:"CT",label:"Connecticut"},{value:"DE",label:"Delaware"},{value:"FL",label:"Florida"},{value:"GA",label:"Georgia"},{value:"HI",label:"Hawaii"},{value:"ID",label:"Idaho"},{value:"IL",label:"Illinois"},{value:"IN",label:"Indiana"},{value:"IA",label:"Iowa"},{value:"KS",label:"Kansas"},{value:"KY",label:"Kentucky"},{value:"LA",label:"Louisiana"},{value:"ME",label:"Maine"},{value:"MD",label:"Maryland"},{value:"MA",label:"Massachusetts"},{value:"MI",label:"Michigan"},{value:"MN",label:"Minnesota"},{value:"MS",label:"Mississippi"},{value:"MO",label:"Missouri"},{value:"MT",label:"Montana"},{value:"NE",label:"Nebraska"},{value:"NV",label:"Nevada"},{value:"NH",label:"New Hampshire"},{value:"NJ",label:"New Jersey"},{value:"NM",label:"New Mexico"},{value:"NY",label:"New York"},{value:"NC",label:"North Carolina"},{value:"ND",label:"North Dakota"},{value:"OH",label:"Ohio"},{value:"OK",label:"Oklahoma"},{value:"OR",label:"Oregon"},{value:"PA",label:"Pennsylvania"},{value:"RI",label:"Rhode Island"},{value:"SC",label:"South Carolina"},{value:"SD",label:"South Dakota"},{value:"TN",label:"Tennessee"},{value:"TX",label:"Texas"},{value:"UT",label:"Utah"},{value:"VT",label:"Vermont"},{value:"VA",label:"Virginia"},{value:"WA",label:"Washington"},{value:"WV",label:"West Virginia"},{value:"WI",label:"Wisconsin"},{value:"WY",label:"Wyoming"},{value:"DC",label:"District of Columbia"}],f=[{value:"United States",label:"United States"},{value:"Canada",label:"Canada"},{value:"Mexico",label:"Mexico"},{value:"United Kingdom",label:"United Kingdom"},{value:"Australia",label:"Australia"},{value:"Other",label:"Other"}],y=[{value:"AB",label:"Alberta"},{value:"BC",label:"British Columbia"},{value:"MB",label:"Manitoba"},{value:"NB",label:"New Brunswick"},{value:"NL",label:"Newfoundland and Labrador"},{value:"NS",label:"Nova Scotia"},{value:"NT",label:"Northwest Territories"},{value:"NU",label:"Nunavut"},{value:"ON",label:"Ontario"},{value:"PE",label:"Prince Edward Island"},{value:"QC",label:"Quebec"},{value:"SK",label:"Saskatchewan"},{value:"YT",label:"Yukon"}],N=[{value:"ACT",label:"Australian Capital Territory"},{value:"NSW",label:"New South Wales"},{value:"NT",label:"Northern Territory"},{value:"QLD",label:"Queensland"},{value:"SA",label:"South Australia"},{value:"TAS",label:"Tasmania"},{value:"VIC",label:"Victoria"},{value:"WA",label:"Western Australia"}],w=()=>{const{user:w,isAuthenticated:C}=m(),S=u(),[A,M]=d.useState("personal"),[_,L]=d.useState(!0),[I,F]=d.useState(!1),[T,k]=d.useState(null),[P,z]=d.useState(null),[G,D]=d.useState(null),[B,O]=d.useState(null),[W,E]=d.useState({full_name:"",email:"",phone:"",bio:""}),[U,Y]=d.useState({street:"",city:"",state:"",postalCode:"",country:"Canada",apt_suite:"",address_line2:"",useForSearch:!1}),H=(e=>{switch(e){case"United States":return g;case"Canada":return y;case"Australia":return N;default:return[]}})(U.country),[K,V]=d.useState({}),[R,Q]=d.useState({});d.useEffect((()=>{if(!C)return void S("/login",{state:{from:"/profile"}});(async()=>{var e,a;try{L(!0);const{data:l,error:s}=await h(w.id);if(s)throw new Error(s.message);l&&(E({full_name:l.full_name||"",email:w.email||"",phone:l.phone||"",bio:l.bio||""}),Y({street:l.street||"",city:l.city||"",state:l.state||"",postalCode:l.postal_code||"",country:l.country||"Canada",apt_suite:l.apt_suite||"",address_line2:l.address_line2||"",useForSearch:(null==(a=null==(e=l.preferences)?void 0:e.defaultSearchLocation)?void 0:a.useForSearch)||!1}),l.avatar_url&&O(l.avatar_url))}catch(l){k(l.message)}finally{L(!1)}})()}),[C,S,w]);const J=e=>{const{name:a,value:l}=e.target;E((e=>({...e,[a]:l}))),K[a]&&V((e=>({...e,[a]:null})))},Z=e=>{const{name:a,value:l}=e.target;Y((e=>({...e,[a]:l}))),R[a]&&Q((e=>({...e,[a]:null})))};return _?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(a,{size:"lg",variant:"yellow",message:"Loading your profile..."})}):e.jsxs("div",{className:"py-12 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-lemonade-yellow-light to-white",children:[e.jsxs(c,{children:[e.jsx("title",{children:"My Profile | Lemonade Map"}),e.jsx("meta",{name:"description",content:"Update your Lemonade Map profile and preferences"})]}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-display text-lemonade-blue-dark mb-4",children:"My Lemonade Profile"}),e.jsx("div",{className:"w-24 h-2 bg-lemonade-yellow mx-auto rounded-full mb-6"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Customize your profile and preferences to get the most out of your Lemonade Map experience!"})]}),e.jsxs(l,{className:"shadow-playful-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-lemonade-blue-light p-6 flex flex-col items-center",children:[e.jsxs("div",{className:"relative group",children:[e.jsx(s,{src:B,alt:W.full_name||"User",size:"xl",className:"border-4 border-white shadow-lg"}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 rounded-full opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",children:[e.jsx("label",{htmlFor:"avatar-upload",className:"text-white text-sm font-medium cursor-pointer",children:"Change"}),e.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",className:"hidden",onChange:e=>{const a=e.target.files[0];if(!a)return;if(!["image/jpeg","image/png","image/gif","image/webp"].includes(a.type))return void k("Please upload a valid image file (JPEG, PNG, GIF, or WebP)");if(a.size>5242880)return void k("Image file is too large. Maximum size is 5MB.");const l=new FileReader;l.onloadend=()=>{O(l.result)},l.readAsDataURL(a),D(a),k(null)}})]})]}),e.jsx("h2",{className:"mt-4 text-2xl font-display text-lemonade-blue-dark",children:W.full_name||"Your Profile"}),e.jsx("p",{className:"text-lemonade-blue-dark opacity-75",children:W.email})]}),e.jsxs(l.Body,{className:"px-6 pt-4",children:[T&&e.jsx(r,{type:"error",message:T,className:"mb-6",onClose:()=>k(null)}),P&&e.jsx(r,{type:"success",message:P,className:"mb-6",onClose:()=>z(null)}),e.jsxs(t,{defaultTab:"address"===A?1:0,onChange:e=>M(0===e?"personal":"address"),className:"mb-6",children:[e.jsx(t.Item,{children:"Personal Info"}),e.jsx(t.Item,{children:"Address"}),e.jsx(t.Panel,{children:e.jsx(n,{onSubmit:async e=>{e.preventDefault();const a=x(W);if(V(a),!(Object.keys(a).length>0))try{F(!0),k(null),z(null);const{error:e}=await b(w.id,{full_name:W.full_name,phone:W.phone,bio:W.bio});if(e)throw new Error(e.message);if(G){const{error:e}=await v(w.id,G);if(e)throw new Error(e.message)}z("Profile updated successfully!"),D(null)}catch(l){k(l.message)}finally{F(!1)}},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"full_name",required:!0,children:"Full Name"}),e.jsx(n.Input,{id:"full_name",name:"full_name",value:W.full_name,onChange:J,placeholder:"Your full name",error:K.full_name})]}),e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"email",children:"Email Address"}),e.jsx(n.Input,{id:"email",name:"email",type:"email",value:W.email,disabled:!0,className:"bg-gray-100"}),e.jsx(n.Text,{children:"Email cannot be changed. Contact support if needed."})]}),e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"phone",children:"Phone Number"}),e.jsx(n.Input,{id:"phone",name:"phone",value:W.phone,onChange:J,placeholder:"Your phone number (optional)",error:K.phone})]}),e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"bio",children:"Bio"}),e.jsx(n.Textarea,{id:"bio",name:"bio",value:W.bio,onChange:J,placeholder:"Tell us a bit about yourself...",rows:4,error:K.bio})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(i,{type:"submit",variant:"primary",size:"lg",disabled:I,children:I?e.jsxs(e.Fragment,{children:[e.jsx(a,{size:"sm",variant:"white",className:"mr-2"}),"Saving..."]}):"Save Profile"})})]})})}),e.jsx(t.Panel,{children:e.jsx(n,{onSubmit:async e=>{e.preventDefault();const a=j(U);if(Q(a),!(Object.keys(a).length>0))try{F(!0),k(null),z(null);const{error:e}=await p(w.id,U);if(e)throw new Error(e.message);z("Address updated successfully!")}catch(l){k(l.message)}finally{F(!1)}},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"street",children:"Street Address"}),e.jsx(n.Input,{id:"street",name:"street",value:U.street,onChange:Z,placeholder:"123 Main St",error:R.street})]}),e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"apt_suite",children:"Apartment/Suite"}),e.jsx(n.Input,{id:"apt_suite",name:"apt_suite",value:U.apt_suite,onChange:Z,placeholder:"Apt 4B",error:R.apt_suite})]}),e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"address_line2",children:"Address Line 2"}),e.jsx(n.Input,{id:"address_line2",name:"address_line2",value:U.address_line2,onChange:Z,placeholder:"Building name, Floor, etc.",error:R.address_line2})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"city",children:"City"}),e.jsx(n.Input,{id:"city",name:"city",value:U.city,onChange:Z,placeholder:"Your city",error:R.city})]}),e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"state",children:"State/Province"}),e.jsx(n.Select,{id:"state",name:"state",value:U.state,onChange:Z,options:H,placeholder:"Select state/province",error:R.state})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"postalCode",children:"ZIP/Postal Code"}),e.jsx(n.Input,{id:"postalCode",name:"postalCode",value:U.postalCode,onChange:Z,placeholder:"12345",error:R.postalCode})]}),e.jsxs(n.Group,{children:[e.jsx(n.Label,{htmlFor:"country",children:"Country"}),e.jsx(n.Select,{id:"country",name:"country",value:U.country,onChange:Z,options:f,error:R.country})]})]}),e.jsx("div",{className:"bg-lemonade-yellow-light p-4 rounded-lg border border-lemonade-yellow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-lemonade-blue-dark text-lg",children:"Use as Default Search Location"}),e.jsx("p",{className:"text-sm text-gray-600",children:"When enabled, we'll use this address as your default location when searching for lemonade stands."})]}),e.jsx(o,{checked:U.useForSearch,onChange:e=>{Y((a=>({...a,useForSearch:e})))},label:"",srLabel:"Use address as default search location"})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(i,{type:"submit",variant:"primary",size:"lg",disabled:I,children:I?e.jsxs(e.Fragment,{children:[e.jsx(a,{size:"sm",variant:"white",className:"mr-2"}),"Saving..."]}):"Save Address"})})]})})})]})]})]}),e.jsxs("div",{className:"relative mt-12",children:[e.jsx("div",{className:"absolute -top-16 -left-8 w-16 h-16 text-lemonade-yellow opacity-30 transform rotate-12",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-5-9h10v2H7z"})})}),e.jsx("div",{className:"absolute -bottom-8 -right-8 w-20 h-20 text-lemonade-pink opacity-20 transform -rotate-12",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-5-9h10v2H7z"})})})]})]})]})};export{w as default};
//# sourceMappingURL=ProfilePage-CNmqTvNe.js.map
