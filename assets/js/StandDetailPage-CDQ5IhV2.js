import{j as e,B as s,A as a,C as t,i as n,k as i,T as l,F as r,M as d}from"./vendor-ui-CYdTg3fb.js";import{a as o,u as c,c as m,d as x,L as h}from"./vendor-react-CGzs7eOH.js";import{A as u,u as g,B as p,c as j,a as v,C as f,D as y,E as b}from"./index-L67klWRl.js";import{M as N}from"./Map-DQf5j10X.js";import{u as w,a as _,P as S,L as E}from"./vendor-leaflet-DNyTttW1.js";import"./vendor-supabase-CS0gIFIa.js";const T=({stand:t,onExtend:n})=>{const[i,l]=o.useState(!1),[r,d]=o.useState(null),[c,m]=o.useState(null),[x,h]=o.useState(null),g=o.useRef(null),p=()=>{if(!t.expiration_time)return null;if(!1===t.is_active)return{expired:!0,timeString:"Inactive"};const e=new Date,s=new Date(t.expiration_time),a=new Date(s.getTime()+6e4*s.getTimezoneOffset())-e;if(a<=0)return{expired:!0,timeString:"Expired"};const n=Math.floor(a/36e5),i=Math.floor(a%36e5/6e4),l=Math.floor(a%6e4/1e3);let r="";return n>0&&(r+=`${n} hour${1!==n?"s":""}`),(i>0||0===n)&&(n>0&&(r+=" and "),r+=`${i} minute${1!==i?"s":""}`),0===n&&0===i&&(r=`${l} second${1!==l?"s":""}`),{expired:!1,timeString:r,hours:n,minutes:i,seconds:l,critical:0===n&&i<30}};o.useEffect((()=>{const e=p();if(h(e),!(!1===t.is_active||e&&e.expired))return g.current=setInterval((()=>{const e=p();h(e),(e&&e.expired||!e)&&clearInterval(g.current)}),1e3),()=>{g.current&&clearInterval(g.current)}}),[t.expiration_time,t.is_active]);const j=async()=>{l(!0),d(null),m(null);try{const{data:e,error:s}=await u(t.id);if(s)throw new Error(s.message);const a=new Date,i=new Date(a);i.setHours(23,59,59,999);const l=Math.round((i-a)/36e5);m(`Stand reopened successfully! Active for the next ${l} hours (until midnight).`),n&&e&&n(e)}catch(e){d(e.message)}finally{l(!1)}};if(!t.expiration_time)return e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-yellow-800 mb-2",children:"This stand does not have an expiration time set."}),e.jsx(s,{variant:"secondary",onClick:j,disabled:i,size:"sm",children:i?"Setting expiration...":"Activate until midnight"})]});const v=e=>{const s=new Date(e);return new Date(s.getTime()+6e4*s.getTimezoneOffset()).toLocaleString(void 0,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric",timeZoneName:"short"})},f=()=>{if(!t.expiration_time)return!1;const e=new Date,s=new Date(t.expiration_time),a=new Date(s.getTime()+6e4*s.getTimezoneOffset());return e.getDate()===a.getDate()&&e.getMonth()===a.getMonth()&&e.getFullYear()===a.getFullYear()},y=(null==x?void 0:x.expired)||!1,b=(null==x?void 0:x.critical)||!1;return e.jsxs("div",{className:"rounded-lg p-4 mb-4 "+(y?"bg-red-50 border border-red-200":b?"bg-orange-50 border border-orange-200":"bg-blue-50 border border-blue-200"),children:[r&&e.jsx(a,{variant:"error",className:"mb-3",dismissible:!0,onDismiss:()=>d(null),children:r}),c&&e.jsx(a,{variant:"success",className:"mb-3",dismissible:!0,onDismiss:()=>m(null),children:c}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium "+(y?"text-red-800":b?"text-orange-800":"text-blue-800"),children:"Stand Visibility Status"}),y?e.jsx("p",{className:"text-red-600",children:!1===t.is_active?"This stand is currently inactive and is not visible to the public.":"This stand has expired and is no longer visible to the public."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center "+(b?"text-orange-600":"text-blue-600"),children:[e.jsx("span",{className:"text-lg font-semibold mr-2",children:"Countdown:"}),e.jsx("div",{className:"bg-white rounded-lg px-3 py-2 shadow-sm border border-gray-200",children:e.jsx("span",{className:"font-mono text-lg",children:x?x.timeString:"Calculating..."})})]}),e.jsx("p",{className:"text-gray-600 text-sm mt-2",children:f()?`Expires tonight at midnight (${v(t.expiration_time)})`:`Expires at midnight: ${v(t.expiration_time)}`})]})]}),e.jsx(s,{variant:y?"primary":"secondary",onClick:j,disabled:i,className:"mt-3 md:mt-0",children:i?"Processing...":!1===t.is_active?"Activate Stand":y?"Reopen Stand":f()?"Active Until Tonight":"Active Until Midnight"})]})]})},D=({statistics:s})=>{const a=s||{totalViews:Math.floor(500*Math.random()),uniqueVisitors:Math.floor(200*Math.random()),averageTimeSpent:Math.floor(5*Math.random())+1,popularTimes:[{day:"Monday",hour:"2-4 PM"},{day:"Wednesday",hour:"3-5 PM"},{day:"Saturday",hour:"12-2 PM"}],viewsByDay:[{day:"Mon",views:Math.floor(50*Math.random())},{day:"Tue",views:Math.floor(50*Math.random())},{day:"Wed",views:Math.floor(50*Math.random())},{day:"Thu",views:Math.floor(50*Math.random())},{day:"Fri",views:Math.floor(50*Math.random())},{day:"Sat",views:Math.floor(50*Math.random())},{day:"Sun",views:Math.floor(50*Math.random())}]},n=Math.max(...a.viewsByDay.map((e=>e.views)));return e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[e.jsx("h3",{className:"text-blue-800 text-lg mb-1",children:"Total Views"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:a.totalViews})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4 text-center",children:[e.jsx("h3",{className:"text-green-800 text-lg mb-1",children:"Unique Visitors"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:a.uniqueVisitors})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[e.jsx("h3",{className:"text-purple-800 text-lg mb-1",children:"Avg. Time (min)"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:a.averageTimeSpent})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs(t,{children:[e.jsx(t.Header,{children:e.jsx("h3",{className:"text-xl font-display text-lemonade-blue-dark",children:"Views by Day"})}),e.jsx(t.Body,{className:"p-4",children:e.jsx("div",{className:"h-64 flex items-end justify-between",children:a.viewsByDay.map(((s,a)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-8 bg-lemonade-blue rounded-t-md",style:{height:s.views/n*100+"%",minHeight:"10px"}}),e.jsx("span",{className:"mt-2 text-sm text-gray-600",children:s.day})]},a)))})})]}),e.jsxs(t,{children:[e.jsx(t.Header,{children:e.jsx("h3",{className:"text-xl font-display text-lemonade-blue-dark",children:"Popular Times"})}),e.jsx(t.Body,{children:e.jsx("ul",{className:"divide-y divide-gray-200",children:a.popularTimes.map(((s,a)=>e.jsxs("li",{className:"py-3 flex justify-between",children:[e.jsx("span",{className:"font-medium",children:s.day}),e.jsx("span",{className:"text-gray-600",children:s.hour})]},a)))})})]})]}),e.jsx("div",{className:"p-4 bg-yellow-50 rounded-lg",children:e.jsx("p",{className:"text-yellow-800 text-sm",children:"Note: These statistics are for demonstration purposes only. In a production environment, this would be connected to real analytics data."})})]})},M=({position:s,onPositionChange:a,popupContent:t,icon:n,draggable:i=!0})=>{const l=o.useRef(null),r=w(),[d,c]=o.useState(s);o.useEffect((()=>{s&&s[0]&&s[1]&&c(s)}),[s]);const m={dragend(){const e=l.current;if(e){const s=e.getLatLng();c([s.lat,s.lng]),a&&a([s.lat,s.lng])}}};return o.useEffect((()=>{d&&d[0]&&d[1]&&r.setView(d,r.getZoom())}),[]),e.jsx(_,{draggable:i,eventHandlers:m,position:d,ref:l,icon:n,children:t&&e.jsx(S,{children:t})})};M.propTypes={position:n.arrayOf(n.number).isRequired,onPositionChange:n.func,popupContent:n.node,icon:n.instanceOf(E.Icon),draggable:n.bool};const C=()=>{var n;const{id:u}=c(),w=m(),_=x(),{user:S}=g(),E=null==(n=_.state)?void 0:n.standData,[C,I]=o.useState(null),[$,k]=o.useState([]),[L,P]=o.useState(!0),[A,F]=o.useState(null),[R,G]=o.useState(null),[U,q]=o.useState("details"),[V,z]=o.useState(!1),[O,B]=o.useState(!1),[Y,H]=o.useState(null),[W,Z]=o.useState({name:"",description:"",address:"",location_lat:"",location_lng:"",is_active:!0}),[J,K]=o.useState(null),[Q,X]=o.useState(null),[ee,se]=o.useState(!1),[ae,te]=o.useState(!1),[ne,ie]=o.useState(!1),[le,re]=o.useState({totalViews:Math.floor(500*Math.random()),uniqueVisitors:Math.floor(200*Math.random()),averageTimeSpent:Math.floor(5*Math.random())+1,popularTimes:[{day:"Monday",hour:"2-4 PM"},{day:"Wednesday",hour:"3-5 PM"},{day:"Saturday",hour:"12-2 PM"}]});o.useEffect((()=>{S?(async()=>{try{if(P(!0),F(null),p.info("Fetching stand data",{standId:u}),!S||!S.id)throw p.error("Authentication error",new Error("User not available or missing ID"),{standId:u,userExists:!!S}),new Error("Authentication error. Please try logging in again.");let e,s;if(E&&E.id===u)p.info("Using stand data from state",{standId:u}),e=E;else{p.apiRequest(`stands/${u}`,"GET");const a=await j(u);if(e=a.data,s=a.error,s)throw p.apiError(`stands/${u}`,"GET",s),new Error(`Failed to load stand: ${s.message}`)}if(!e)throw p.warn("Stand not found",{standId:u}),new Error("Stand not found. It may have been deleted.");let a={...e};if("string"==typeof a.location_lat&&(a.location_lat=parseFloat(a.location_lat)||0),"string"==typeof a.location_lng&&(a.location_lng=parseFloat(a.location_lng)||0),p.apiResponse(`stands/${u}`,"GET",{standExists:!!a},200),a.owner_id!==S.id)throw p.warn("Permission denied",{standId:u,standOwnerId:a.owner_id,userId:S.id}),new Error("You do not have permission to view this stand");p.info("Stand data loaded successfully",{standId:u,standName:a.name,isActive:a.is_active}),I(a),Z({name:a.name||"",description:a.description||"",address:a.address||"",location_lat:a.location_lat||"",location_lng:a.location_lng||"",is_active:a.is_active}),p.apiRequest(`products?standId=${u}`,"GET");const{data:t,error:n}=await v(u);n?(p.apiError(`products?standId=${u}`,"GET",n),p.warn("Failed to load products, continuing with empty products list",{error:n.message}),k([])):(p.apiResponse(`products?standId=${u}`,"GET",{productCount:(null==t?void 0:t.length)||0},200),k(t||[]))}catch(e){p.error("Error fetching stand data",e,{standId:u}),F(e.message||"Something went wrong. Please try again."),I(null)}finally{P(!1)}})():p.info("Waiting for user data before fetching stand",{standId:u})}),[u,S]);const de=e=>{const{name:s,value:a,type:t,checked:n}=e.target;Z((e=>({...e,[s]:"checkbox"===t?n:a})))};return L&&!C?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex flex-col justify-center items-center h-64",children:e.jsx(i,{size:"lg",variant:"blue",message:"Loading stand details..."})})}):A?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-4",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark mb-4",children:"Error Loading Stand"}),e.jsx(a,{variant:"error",className:"mb-6",dismissible:!0,onDismiss:()=>F(null),children:A}),e.jsx("p",{className:"text-gray-600 mb-6",children:"There was a problem loading the stand details. This could be due to:"}),e.jsxs("ul",{className:"list-disc list-inside text-gray-600 mb-6",children:[e.jsx("li",{children:"The stand may have been deleted"}),e.jsx("li",{children:"You may not have permission to view this stand"}),e.jsx("li",{children:"There might be a temporary server issue"}),e.jsx("li",{children:"Your session may have expired"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(h,{to:"/seller/dashboard",children:e.jsx(s,{variant:"primary",children:"Back to Dashboard"})}),e.jsx(s,{variant:"secondary",onClick:()=>window.location.reload(),children:"Try Again"})]})]})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row justify-between items-start md:items-center",children:[e.jsxs("div",{children:[e.jsx(h,{to:"/seller/dashboard",className:"text-lemonade-blue hover:underline mb-2 inline-block",children:"← Back to Dashboard"}),e.jsx("h1",{className:"text-3xl font-display text-lemonade-blue-dark",children:C.name})]}),e.jsxs("div",{className:"flex space-x-2 mt-4 md:mt-0",children:[e.jsxs(s,{variant:C.is_active?"danger-outline":"success",onClick:async()=>{P(!0),F(null),G(null);const e=!C.is_active,s=e?"activate":"deactivate";p.info(`Attempting to ${s} stand`,{standId:u,currentState:C.is_active,newState:e});try{p.apiRequest(`stands/${u}`,"PATCH",{is_active:e});const{data:a,error:t}=await f(u,{is_active:e});if(t)throw p.apiError(`stands/${u}`,"PATCH",t),new Error(`Failed to ${s} stand: ${t.message}`);p.apiResponse(`stands/${u}`,"PATCH",{success:!0},200),p.info(`Stand ${s}d successfully`,{standId:u}),I({...C,is_active:e}),Z((s=>({...s,is_active:e}))),G(`Stand ${e?"activated":"deactivated"} successfully!`)}catch(a){p.error(`Error ${s}ing stand`,a,{standId:u}),F(a.message)}finally{P(!1)}},disabled:L,children:[C.is_active?"Deactivate":"Activate"," Stand"]}),e.jsx(s,{variant:"danger",onClick:()=>te(!0),children:"Delete Stand"})]})]}),A&&e.jsx(a,{variant:"error",className:"mb-4",dismissible:!0,onDismiss:()=>F(null),children:A}),R&&e.jsx(a,{variant:"success",className:"mb-4",dismissible:!0,onDismiss:()=>G(null),children:R}),e.jsx(T,{stand:C,onExtend:e=>{I(e)}}),e.jsx(l,{activeTab:U,onChange:q,tabs:[{id:"details",label:"Stand Details"},{id:"products",label:"Products"},{id:"statistics",label:"Visitor Statistics"}],className:"mb-6"}),"details"===U&&e.jsx("div",{className:"bg-white rounded-xl shadow-md p-6",children:V?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark",children:"Edit Stand Details"}),e.jsx(s,{variant:"secondary",onClick:()=>{z(!1),K(null),X(null),Z({name:C.name||"",description:C.description||"",address:C.address||"",location_lat:C.location_lat||"",location_lng:C.location_lng||"",is_active:C.is_active})},children:"Cancel"})]}),e.jsxs(r,{onSubmit:async e=>{e.preventDefault(),P(!0),F(null),G(null),p.info("Submitting stand update form",{standId:u,hasImageUpdate:!!J});try{if(!W.name.trim())throw new Error("Stand name is required");p.apiRequest(`stands/${u}`,"PUT",{formData:{...W,name:W.name.trim()}});const{data:e,error:s}=await f(u,{...W,name:W.name.trim()});if(s)throw p.apiError(`stands/${u}`,"PUT",s),new Error(`Failed to update stand: ${s.message}`);if(p.apiResponse(`stands/${u}`,"PUT",{success:!0},200),J){se(!0),p.info("Uploading stand image",{standId:u,imageSize:J.size,imageType:J.type}),p.apiRequest(`stands/${u}/image`,"POST");const{error:e}=await y(u,S.id,J);if(e)throw p.apiError(`stands/${u}/image`,"POST",e),new Error(`Error uploading image: ${e.message}`);p.apiResponse(`stands/${u}/image`,"POST",{success:!0},200),p.apiRequest(`stands/${u}`,"GET");const{data:s,error:a}=await j(u);if(a)throw p.apiError(`stands/${u}`,"GET",a),new Error(`Error refreshing stand data: ${a.message}`);p.apiResponse(`stands/${u}`,"GET",{success:!0},200),I(s)}else I(e[0]);p.info("Stand updated successfully",{standId:u}),G("Stand updated successfully!"),z(!1),K(null),X(null)}catch(s){p.error("Error updating stand",s,{standId:u}),F(s.message)}finally{P(!1),se(!1)}},children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("div",{className:"rounded-lg overflow-hidden border border-gray-200 mb-4",children:Q?e.jsx("img",{src:Q,alt:"Preview",className:"w-full h-64 object-cover"}):C.image_url?e.jsx("img",{src:C.image_url,alt:C.name,className:"w-full h-64 object-cover"}):e.jsx("div",{className:"w-full h-64 bg-lemonade-yellow-light flex items-center justify-center",children:e.jsx("span",{className:"text-lemonade-yellow-dark",children:"No Image"})})}),e.jsxs(r.Group,{children:[e.jsx(r.Label,{htmlFor:"image",children:"Stand Image"}),e.jsx(r.Input,{id:"image",name:"image",type:"file",accept:"image/*",onChange:e=>{const s=e.target.files[0];if(s){K(s);const e=new FileReader;e.onloadend=()=>{X(e.result)},e.readAsDataURL(s)}}}),e.jsx(r.Text,{children:"Upload an image of your lemonade stand."})]}),e.jsxs(r.Group,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(r.Checkbox,{id:"is_active",name:"is_active",checked:W.is_active,onChange:de}),e.jsx(r.Label,{htmlFor:"is_active",className:"ml-2 mb-0",children:"Stand is active"})]}),e.jsx(r.Text,{children:"Inactive stands are not visible to the public."})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs(r.Group,{children:[e.jsx(r.Label,{htmlFor:"name",required:!0,children:"Stand Name"}),e.jsx(r.Input,{id:"name",name:"name",value:W.name,onChange:de,placeholder:"Enter stand name",required:!0})]}),e.jsxs(r.Group,{children:[e.jsx(r.Label,{htmlFor:"description",children:"Description"}),e.jsx(r.Textarea,{id:"description",name:"description",value:W.description,onChange:de,placeholder:"Describe your lemonade stand",rows:4})]}),e.jsxs(r.Group,{children:[e.jsx(r.Label,{htmlFor:"address",children:"Address"}),e.jsx(r.Input,{id:"address",name:"address",value:W.address,onChange:de,placeholder:"Enter stand address"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(r.Group,{children:[e.jsx(r.Label,{htmlFor:"location_lat",children:"Latitude"}),e.jsx(r.Input,{id:"location_lat",name:"location_lat",type:"number",step:"any",value:W.location_lat,onChange:de,placeholder:"Enter latitude"})]}),e.jsxs(r.Group,{children:[e.jsx(r.Label,{htmlFor:"location_lng",children:"Longitude"}),e.jsx(r.Input,{id:"location_lng",name:"location_lng",type:"number",step:"any",value:W.location_lng,onChange:de,placeholder:"Enter longitude"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(s,{type:"button",variant:"secondary",onClick:()=>{C&&C.location_lat&&C.location_lng?H([C.location_lat,C.location_lng]):W.location_lat&&W.location_lng?H([parseFloat(W.location_lat),parseFloat(W.location_lng)]):H([39.8283,-98.5795]),B(!0)},className:"w-full flex items-center justify-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),"Set Location on Map (Drag & Drop)"]})})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx(s,{type:"submit",variant:"primary",disabled:L||ee,children:L||ee?"Saving...":"Save Changes"})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark",children:"Stand Details"}),e.jsx(s,{variant:"primary",onClick:()=>z(!0),children:"Edit Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsx("div",{className:"rounded-lg overflow-hidden border border-gray-200",children:C.image_url?e.jsx("img",{src:C.image_url,alt:C.name,className:"w-full h-64 object-cover"}):e.jsx("div",{className:"w-full h-64 bg-lemonade-yellow-light flex items-center justify-center",children:e.jsx("span",{className:"text-lemonade-yellow-dark",children:"No Image"})})})}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Name"}),e.jsx("p",{className:"text-gray-800 font-medium",children:C.name})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Status"}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(C.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:C.is_active?"Active":"Inactive"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Description"}),e.jsx("p",{className:"text-gray-800",children:C.description||"No description provided."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Address"}),e.jsx("p",{className:"text-gray-800",children:C.address||"No address provided."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Latitude"}),e.jsx("p",{className:"text-gray-800 font-mono",children:C.location_lat||"N/A"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Longitude"}),e.jsx("p",{className:"text-gray-800 font-mono",children:C.location_lng||"N/A"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Created"}),e.jsx("p",{className:"text-gray-800",children:new Date(C.created_at).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-gray-500 text-sm",children:"Last Updated"}),e.jsx("p",{className:"text-gray-800",children:new Date(C.updated_at).toLocaleDateString()})]})]})})]})]})}),"products"===U&&e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark",children:"Products"}),e.jsx(h,{to:`/seller/stands/${u}/products/new`,children:e.jsx(s,{variant:"primary",children:"Add New Product"})})]}),0===$.length?e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"You don't have any products for this stand yet."}),e.jsx(h,{to:`/seller/stands/${u}/products/new`,children:e.jsx(s,{variant:"primary",children:"Add Your First Product"})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:$.map((s=>e.jsxs(t,{className:"hover:shadow-md transition",children:[e.jsx("div",{className:"h-48 bg-gray-100",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-lemonade-yellow-light flex items-center justify-center",children:e.jsx("span",{className:"text-lemonade-yellow-dark",children:"No Image"})})}),e.jsxs(t.Body,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-xl font-display text-lemonade-blue-dark",children:s.name}),e.jsxs("span",{className:"text-lg font-semibold text-lemonade-blue",children:["$",s.price.toFixed(2)]})]}),e.jsx("p",{className:"text-gray-600 mb-3 line-clamp-2",children:s.description||"No description"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(s.is_available?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:s.is_available?"Available":"Unavailable"}),e.jsx(h,{to:`/seller/stands/${u}/products/${s.id}`,className:"text-lemonade-blue hover:underline",children:"Edit →"})]})]})]},s.id)))})]}),"statistics"===U&&e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h2",{className:"text-2xl font-display text-lemonade-blue-dark mb-6",children:"Visitor Statistics"}),e.jsx(D,{statistics:le})]}),e.jsx(d,{isOpen:ae,onClose:()=>te(!1),title:"Delete Stand",children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-700 mb-6",children:"Are you sure you want to delete this stand? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(s,{variant:"secondary",onClick:()=>te(!1),disabled:ne,children:"Cancel"}),e.jsx(s,{variant:"danger",onClick:async()=>{ie(!0),F(null),p.info("Deleting stand",{standId:u});try{if(!C||C.owner_id!==S.id)throw p.warn("Unauthorized deletion attempt",{standId:u,userId:S.id,standOwnerId:null==C?void 0:C.owner_id}),new Error("You do not have permission to delete this stand");p.apiRequest(`stands/${u}`,"DELETE");const{error:e}=await b(u);if(e)throw p.apiError(`stands/${u}`,"DELETE",e),new Error(`Failed to delete stand: ${e.message}`);p.apiResponse(`stands/${u}`,"DELETE",{success:!0},200),p.info("Stand deleted successfully",{standId:u}),w("/seller/dashboard",{state:{message:"Stand deleted successfully!"}})}catch(e){p.error("Error deleting stand",e,{standId:u}),F(e.message),te(!1)}finally{ie(!1)}},disabled:ne,children:ne?"Deleting...":"Delete Stand"})]})]})}),O&&e.jsx(d,{isOpen:O,onClose:()=>B(!1),title:"Adjust Stand Location",size:"lg",children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"mb-4 text-gray-700",children:"Drag the marker to set your stand's exact location. Click \"Save Location\" when you're done."}),e.jsx("div",{className:"h-96 mb-4 rounded-lg overflow-hidden",children:Y&&e.jsx(N,{center:Y,zoom:15,height:"100%",showUserLocation:!0,children:e.jsx(M,{position:Y,onPositionChange:e=>{Z((s=>({...s,location_lat:e[0],location_lng:e[1]})))},popupContent:e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-base",children:"Your Stand Location"}),e.jsx("p",{className:"text-sm",children:"Drag me to adjust!"})]})})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),e.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded-md",value:W.location_lat,onChange:e=>Z((s=>({...s,location_lat:e.target.value})))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),e.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded-md",value:W.location_lng,onChange:e=>Z((s=>({...s,location_lng:e.target.value})))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(s,{variant:"secondary",onClick:()=>B(!1),children:"Cancel"}),e.jsx(s,{variant:"primary",onClick:()=>B(!1),children:"Save Location"})]})]})})]})};export{C as default};
//# sourceMappingURL=StandDetailPage-CDQ5IhV2.js.map
